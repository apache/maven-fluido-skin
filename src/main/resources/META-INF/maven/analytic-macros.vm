## Licensed to the Apache Software Foundation (ASF) under one
## or more contributor license agreements.  See the NOTICE file
## distributed with this work for additional information
## regarding copyright ownership.  The ASF licenses this file
## to you under the Apache License, Version 2.0 (the
## "License"); you may not use this file except in compliance
## with the License.  You may obtain a copy of the License at
##
##     http://www.apache.org/licenses/LICENSE-2.0
##
## Unless required by applicable law or agreed to in writing,
## software distributed under the License is distributed on an
## "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
## KIND, either express or implied.  See the License for the
## specific language governing permissions and limitations
## under the License.
##
#macro ( piwik )
#**##if ( $decoration.getCustomChild( 'fluidoSkin.piwik.piwikUrl' )
        && $decoration.getCustomChild( 'fluidoSkin.piwik.idsite' ) )
#*  *##set ( $piwikUrl =  $decoration.getCustomValue( 'fluidoSkin.piwik.piwikUrl' ) )
#*  *##set ( $idsite =  $decoration.getCustomValue( 'fluidoSkin.piwik.idsite' ) )
##
    <!-- Piwik -->
    <script>
    var pkBaseURL = (("https:" == document.location.protocol) ? "https://$piwikUrl/" : "http://$piwikUrl/");
    document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js'%3E%3C/script%3E"));
    </script><script>
    try {
    var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", $idsite);
    piwikTracker.trackPageView();
    piwikTracker.enableLinkTracking();
    } catch( err ) {}
    </script><noscript><p><img src="http://$piwikUrl/piwik.php?idsite=$idsite" style="border: 0;" alt="Piwik"/></p></noscript>
    <!-- End Piwik Tag -->
#**##end
#end
##
#macro ( googleAnalytics $accountId )
#**##if( $accountId && $accountId != "" )
    <!-- Google Analytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
       (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', '$accountId', 'auto');
      ga('send', 'pageview');
#**##if( $convert.toBoolean( $decoration.getCustomValue( 'fluidoSkin.googleAnalytics.anonymizeIp', 'true' ) ) )
      ga('set', 'anonymizeIp', true);
#**##end
#**##if( $convert.toBoolean( $decoration.getCustomValue( 'fluidoSkin.googleAnalytics.forceSSL', 'true' ) ) )
      ga('set', 'forceSSL', true);
#**##end
    </script>
#**##end
#end
##
#macro ( matomo $matomoDom )
#**##if (  $decoration.getCustomValue( 'matomo.url' ) && $decoration.getCustomValue( 'matomo.url' ) != ''
&& $decoration.getCustomValue( 'matomo.siteId' ) && $decoration.getCustomValue( 'matomo.siteId' ) != '')

    <!-- Matomo -->
    <script>
        var _paq = window._paq = window._paq || [];
    #*    *##foreach( $option in $matomoDom.getChild("options").getChildren() )
    #*      *##if( $option.value && $option.value != "" )
        _paq.push(['$option.name', '$option.value']);
    #*      *##else
        _paq.push(['$option.name']);
    #*      *##end
    #*    *##end

        (function() {
            var u="$decoration.getCustomValue( 'matomo.url' )";
            _paq.push(['setTrackerUrl', u+'/matomo.php']);
            _paq.push(['setSiteId', '$decoration.getCustomValue( 'matomo.siteId' )']);
            var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
            g.async=true; g.src=u+'/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
    </script>
    <!-- End Matomo Code -->
#**##end
#end